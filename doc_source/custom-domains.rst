.. _custom-domains:

#########################
Setting Up Custom Domains
#########################

You can connect a custom domain purchased through domain registrars (for example, Amazon Route 53, GoDaddy, and Google Domains) to your app. When you deploy your web app with the Amplify Console, it is hosted at:

.. code-block:: none

	https://branch-name.d1m7bkiki6tdw1.amplifyapp.com

When you use a custom domain, users see that your app is hosted from a URL, such as the following:

.. code-block:: none

	https://www.awesomedomain.com

The Amplify Console issues an SSL certificate for all domains connected to your app so that all traffic is secured through HTTPS/2. The SSL certificate generated by Amazon Certificate Manager is valid for 30 days and renews automatically as long as your app is hosted with Amplify.

.. contents::
   :local:
   :depth: 1


.. _custom-domain-route53:

Adding a Custom Domain Managed in Amazon Route 53
=================================================

After you deploy your app, you can add a custom domain that you manage using Amazon Route 53. 

1. On the left navigation pane, choose **App Settings**, **Domain management**, and then choose **Add domain**.

   .. image:: images/amplify-customdomain-1.png

2. In **Enter your root domain**, enter your root domain (`https://awesomedomain.com`). As you start typing, root domains that you manage in Amazon Route 53 appear in the list (`https://awesomedomain.com`). Select the domain you want to use and then choose **Configure Domain**. 

   .. image:: images/amplify-customdomain-2.png

3. By default, the Amplify Console automatically adds two entries for `https://www.myroute53domain.com` and `https://myroute53domain.com` with a redirect set up from the `www` subdomain to the root domain (you can change this by choosing **Rewrites and redirects** from the left menu). You can modify the default configuration if you want to add subdomains only, see: :ref:`Connecting subdomains <custom-domain-subdomains>`. Choose **Save** after configuring your domain. 
 
   .. image:: images/amplify-customdomain-configure.png  

**Note:** It can take up to 24 hours for the DNS to propagate and to issue the SSL certificate. For more information about the status messages, see :ref:`Associating a Domain <custom-domain-status>`.

.. _custom-domain-third-party:

Adding a Custom Domain Managed by a Third-Party DNS Provider
============================================================

After you deploy your app, you can add a custom domain that you manage using a third-party DNS provider if you don't use Amazon Route 53. 

1. On the left navigation pane, choose **App Settings**, **Domain management**, and then choose **Add domain**.

2. In **Enter your root domain**, enter your root domain (`https://awesomedomain.com`) and then choose **Configure domain**. If the domain is registered, a green alert notifies you to proceed as long you are the owner of the domain. If the domain is available, purchase a domain at `Amazon Route 53 <https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-register.html>`__.

   .. image:: images/amplify-customdomain-3.png

3. By default, the Amplify Console adds two entries for `https://www.awesomedomain.com` and `https://awesomedomain.com` with a redirect set up from the `www` subdomain to the root domain. You can modify the default configuration if you want to add subdomains only, see: :ref:`Connecting subdomains <custom-domain-subdomains>`. Choose **Save** after configuring your domain. 

4. Because the domain is managed externally you must manually configure your DNS provider (for example, GoDaddy or Google domains). Choose **View DNS records** in the alert banner. 

   .. image:: images/amplify-customdomain-4.png

5. Update your DNS providers' CNAME and ALIAS records as follows. For GoDaddy and Google Domains, see the step-by-step instructions in :ref:`Connecting to Third-Party Custom Domains <howto-third-party-domains>`.

   1. To generate a SSL certificate for your domain, Amazon Certificate Manager (ACM) needs to verify ownership. Configure a CNAME to point to ACM's validation server. Once ACM validates ownership of your domain, all traffic will be served using HTTPS/2. 

   2. Configure CNAME record to point your subdomains (`https://*.awesomedomain.com`) to the amplifyapp domain. **NOTE: If you have production traffic it is recommended you update your CNAME record after your domain status shows AVAILABLE.*

   3. Configure ANAME/ALIAS record to point the root domain (`https://awesomedomain.com`) to your amplifyapp domain. ANAME records enable you to point the root of your domain to a hostname. For DNS providers that do not have ANAME/ALIAS support, we strongly recommend `migrating your DNS to Amazon Route 53 <https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-configuring.html>`__. **NOTE: If you have production traffic it is recommended you update your ANAME record after your domain status shows AVAILABLE.*

      .. image:: images/amplify-customdomain-5.png

**Important:** Verification of domain ownership and DNS propagation for third-party domains can take up to 48 hours. For more information about status messages, see :ref:`Associating a Domain <custom-domain-status>`.

.. _custom-domain-subdomains:

Adding Subdomains
===================

A subdomain is the part of your URL that appears before your domain name (for example, `www`.amazon.com or `aws`.amazon.com). 

1. **Add a subdomain only**: If you already have a production website, you might only want to connect a subdomain (eg `https://alpha.mydomain.com`). You can do this by choosing **Exclude root** and modifying the subdomain to `alpha` as shown below. 

   .. image:: images/amplify-customdomain-configure-2.png 

2. **Add a multi-level subdomain**: You might want to connect a multi-level subdomain (eg `https://beta.alpha.mydomain.com`). You can do this by entering `alpha.mydomain.com` in the domain search bar, choosing **Exclude root**, and modifying the subdomain to `beta` as shown below. 

   .. image:: images/amplify-customdomain-configure-3.png

3. **Manage subdomains** After adding your domain, you might want to add more subdomains. Choose **Manage subdomains** from the Domain management screen and edit your subdomains.

   .. image:: images/amplify-customdomain-6.png

.. _custom-domain-status:

Custom Domain status
====================

When you are associating a domain with your Amplify app deployment, you see the following status messages:

1. **In Progress** - First attempt at updating your DNS record. This indicates that Amplify is able to update records managed in Route 53, but unable to do so for third-party DNS providers.

2. **Pending verification** - Before issuing an SSL certificate, Amazon Certificate Manager (ACM) must verify that you are the owner of the domain. Domains managed outside Amazon Route 53 usually take the longest time to verify.

3. **Pending deployment** - After domain verification, the DNS is propagated globally to all 144 points of presence of our CDN.

4. **Available** - The domain is successfully associated with your app.
